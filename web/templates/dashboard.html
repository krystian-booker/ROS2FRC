{% extends "layout.html" %}

{% block content %}
<h1>FRC VisionTools</h1>
<div id="status" class="status mb-3">Connectingâ€¦</div>
<script>
    const ros = new ROSLIB.Ros({ url: 'ws://{{ localIP }}:9090' });
    const statusEl = document.getElementById('status');

    ros.on('connection', () => {
        statusEl.textContent = 'ðŸŸ¢ Connected to ROS!';
        statusEl.className = 'status connected mb-3';
    });
    ros.on('error', () => {
        statusEl.textContent = 'ðŸ”´ Connection error';
        statusEl.className = 'status error mb-3';
    });
    ros.on('close', () => {
        statusEl.textContent = 'âšª Connection closed';
        statusEl.className = 'status closed mb-3';
    });

    const listener = new ROSLIB.Topic({ ros, name: '/chatter', messageType: 'std_msgs/String' });
    listener.subscribe(msg => {
        console.log('Received on /chatter:', msg.data);
        listener.unsubscribe();
    });
</script>
{% endblock %}